**Conditional Generation Net for Medication Recommendation**

ABSTRACT

药物推荐的目标是根据患者的诊断提供一套合适的药物，这是临床的一项重要任务。目前，该建议是由医生手动执行的。但对于复杂的情况，比如患者同时患有多种疾病，即使是经验丰富的医生也很难给出周到的建议。这促使自动药物推荐的出现，它可以帮助治疗已诊断的疾病，而不会引起有害的药物-药物相互作用。由于其临床应用价值，药物推荐越来越受到人们的关注。现有的工作主要是将药物推荐作为一个多标签分类任务来预测药物集合。在本文中，我们提出了条件生成网(COGNet)，它引入了一种新的复制或预测机制来生成药物集。对于一个病人，所提出的模型首先检索他或她的历史诊断和药物建议，并挖掘它们与当前诊断的关系。然后，在预测每种药物时，所提出的模型决定是根据以前的建议复制一种药物，还是预测一种新的药物。这个过程与人类医生的决策过程非常相似。

2 PROBLEM FORMULATION
2.1 Electrical Health Records (EHR)

电子病历(EHR)的基本单位是病人，每个病人由几次就诊组成。设![image-20221214193659269](https://gitee.com/ning13445/picture/raw/master/1/image-20221214193659269.png)表示N例患者的纵向EHR。每个病人至少来过医院一次，第i个病人可以表示为一个多变量观察序列![image-20221214193832459](https://gitee.com/ning13445/picture/raw/master/1/image-20221214193832459.png)。这里T (i)是第i个病人的就诊次数。为了简化符号，我们忽略索引i，用单个病人描述我们的方法，然后用V = [V1, V2，···，VT]表示一个病人。

设D = {d1, d2，···，D | D |}表示诊断集合，P = {p1, p2，···，P | P |}表示进程集合，M = {m1, m2，···，M |M |}表示药物集合。|D|， |P |和|M|分别表示所有可能的诊断、进程和药物的数量。那么，患者的每次就诊可以用Vt = {Dt, Pt, Mt}表示，其中Dt⊆D, Pt⊆P, Mt⊆M。

2.2 EHR&DDI Graph

Ge = {M, Ee}和Gd = {M, Ed}分别表示EHR图和**药物之间相互作用**(DDI)图，其中Ee为R中所有可能的药物组合，Ed为已知的DDI。

形式上，我们使用邻接矩阵![image-20221214194838559](https://gitee.com/ning13445/picture/raw/master/1/image-20221214194838559.png)来说明图的构造。Ae [i, j] = 1表示同一次就诊出现第i和第j种药物。对于Ad，仅考虑成对ddi, Ad [i, j] = 1表示第i个和第j个药物相互作用。所有患者的Ge和Gd都是相同的。

2.3 Medication Recommendation Problem

给定患者当前诊断Dt、进程Pt、历史就诊信息[V1, V2，···，Vt−1]，以及EHR和DDI图Ge和Gd，目标是训练一个模型(即COGNet)，该模型可以为该患者推荐合适的药物组合Mt。

D1  D2  D3......DT-1   DT                  每次就诊，进程，药物可为多个

P1  P2   P3.......PT-1   PT

M1 M2  M3.....MT-1   ?

![image-20221214190747649](https://gitee.com/ning13445/picture/raw/master/1/image-20221214190747649.png)

3 FRAMEWORK

图3说明了COGNet的体系结构。我们采用基于编码器-解码器的生成网络，根据患者当前和历史的健康状况生成适当的药物组合。在编码器中，我们将历史就诊的所有医疗代码(即V1,V2，···，Vt−1)编码，以表示患者的历史健康状况，并编码第t次就诊的诊断和程序代码，以表示患者当前的健康状况。在解码器中，我们将逐个生成药物，组成推荐药物组合。在每个解码步骤中，解码器结合诊断、程序和生成的药物的信息来推荐下一个药物。此外，如果当前就诊的某些疾病与以往就诊一致，复制模块将直接从历史药物组合中复制相应的药物。我们将首先描述基本的基于编码器-解码器的生成模型，然后在下面的小节中详细介绍复制模块。

3.1 Input Representations

我们设计了三个嵌入表，Ed, Ep和**Em**，其中每一行都是一个不同的诊断代码、程序代码或药物代码的嵌入向量。对于每一个诊断集Di (i∈[1,t])，我们首先通过嵌入矩阵Ed将它的每一个元素d∈Di转换为一个s维向量d，然后我们可以得到诊断集Di的表示。对于每个进程集Pi (t∈[1,t])和药物集Mj (j∈[1,t−1])，我们也可以分别通过嵌入矩阵Ep和Em得到它们的表示形式Pi和Mj。

3.2 Basic Model

在基本模型中，我们仅根据患者当前就诊的健康状况来推荐药物组合。基本模型是编码器-解码器生成模型。它由四个模块组成:诊断编码器、进程编码器、药物图编码器和药物组合编码器。

3.2.1诊断编码器。诊断编码器的目标是基于诊断代码来表示患者的健康状况。它是一个基于Transformer的[22]网络

输入Dt，输出![image-20221214202554142](https://gitee.com/ning13445/picture/raw/master/1/image-20221214202554142.png)

其中![image-20221214202554142](https://gitee.com/ning13445/picture/raw/master/1/image-20221214202554142.png)是该编码器编码的第t次就诊的诊断表示。

3.2.2过程编码器。过程编码器与诊断编码器具有相同的网络结构，但它们的参数不同。通过同样的编码过程，我们也可以通过过程编码器得到过程表示P 't:

![image-20221214202637664](https://gitee.com/ning13445/picture/raw/master/1/image-20221214202637664.png)

3.2.3药物图表编码器。该编码器旨在模拟两种药物关系:

•药物EHR共现关系:为了更好的疗效，一些药物经常同时开。例如，雷尼替丁和蔗糖酸盐是治疗急性胃炎的常药物物组合。因此，建模这些共现关系可以帮助解码器根据部分生成的药物推荐药物。

•DDI:如上所述，有些药物含有DDI，不能合用。解码器在推荐药物时，应避免与过去推荐的药物发生冲突。因此，建模这种关系可以帮助推荐安全有效的药物组合。

受[19]的启发，我们使用图卷积网络[12]基于药物EHR图和DDI图对两种关系进行建模。

给定输入的药物特征X∈R|M |×s和药物图邻接矩阵A∈R|M |×|M |， GCN(·，·)将得到新的药物表示形式如下:

![image-20221214202807487](https://gitee.com/ning13445/picture/raw/master/1/image-20221214202807487.png)

![image-20221214202909396](https://gitee.com/ning13445/picture/raw/master/1/image-20221214202909396.png), I为单位矩阵，O为A的对角节点度矩阵(也就是![image-20221214203004431](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203004431.png))。

首先，基于EHR图邻接矩阵Ae，使用两层GCN对药物EHR共现关系进行建模。

![image-20221214203048581](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203048581.png)

然后，基于DDI图邻接矩阵Ad，使用另一个两层GCN对DDI关系进行建模。

![image-20221214203153432](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203153432.png)

最后，我们融合了两个药物关系表示Ge和Gd，得到关系感知的药物表示。

![image-20221214203256196](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203256196.png)

3.2.4药物联合解码器。解码器将在第 t 次就诊时逐一推荐药物。例如，在第i个解码步骤，解码器将根据部分生成的药物组合{Mt,0，···，Mt,i−1}和患者第t次就诊时的健康状况(即D 't和P 't)，推荐下一个药物Mt,i。解码过程如下。

首先，我们通过**原始的嵌入矩阵Em**和**关系表示矩阵Eg**将所有生成的药物转化为向量，可以得到部分生成的药物组合的两种表示形式![image-20221217204113724](C:%5CUsers%5Can%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221217204113724.png)。我们将两种表示进行融合，得到关系感知的药物组合表示

![image-20221214203534283](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203534283.png)

然后，我们使用多头自注意机制(定义在式(2))来捕获推荐药物之间的相互作用。

![image-20221214203550725](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203550725.png)

直观地说，药物推荐任务的目的是生成能够覆盖患者所有疾病的药物推荐。因此，患者的疾病和程序表示![image-20221214203650137](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203650137.png)在解码过程中起辅助作用。为此，我们调整患者的健康状况，以自适应地模拟未发现的疾病，以指导下一次药物推荐。

![image-20221214203713297](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203713297.png)

最后，我们使用![image-20221214203816497](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203816497.png)的最后一行通过MLP层预测第i种药物。

![image-20221214203827988](https://gitee.com/ning13445/picture/raw/master/1/image-20221214203827988.png)

其中Wg和bg是可学习参数。Prg表示词汇表中所有药物的概率，其中概率最大的药物是第i步的预测药物。

3.3 Copy Module

在基本模型部分，我们将介绍基于编码器-解码器的模型，以根据患者当前的健康状况生成药物推荐结果。它没有考虑患者的**历史就诊信息**。在本节中，我们设计了一个新颖的复制模块来扩展基本模型，该模块首先比较当前和历史就诊的健康状况，然后根据病情变化复制可重复使用的药物来为当前就诊处方。

由于患者可能多次就诊，我们使用分层选择机制在每个解码步骤进行复制过程。首先，我们使用就诊级别选择，通过比较他们的健康状况来选择相似的就诊。然后，在特定的解码步骤中，我们使药物物级选择从所选就诊的处方中选择特定的药物，并将其添加到推荐结果中。最后，重复上述过程，迭代复制可重复使用的药物，形成完整的推荐药物列表。请注意，选择过程就像注意力机制[26]一样是“soft”，并为所有就诊/药物分配不同的概率以突出选择。我们将以第t次就诊(即Mt,i)的第i次药物建议为例来说明复制过程。

3.3.1就诊级选择。我们首先使用两个门控聚合层，分别通过聚合所有就诊者的诊断和程序表示来编码其就诊级别的健康状况:

![image-20221214204034408](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204034408.png)

然后我们通过测量过去第j次就诊(1≤j≤t−1)与当前第t次就诊的相似度来计算过去第j次就诊的就诊级选择评分。

![image-20221214204131095](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204131095.png)

s：嵌入空间的维数。

3.3.2药物级别选择。我们使用式(12)中给出的隐藏状态![image-20221214204226759](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204226759.png)，综合编码了诊断、程序和推荐药物的信息，来确定哪些历史药物![image-20221214204251405](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204251405.png)在当前情况下可重复使用。

我们首先通过与3.2.1相似的流程获得所有既往就诊的药物记录:

![image-20221214204314243](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204314243.png)

然后，我们使用隐藏状态![image-20221217230335671](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221217230335671.png)作为查询向量，沿着药物维度计算选择得分。第j次就诊第k次药物的选择评分Mj,k(1≤j≤t−1和1≤k≤|Mj |)为

![image-20221214204454288](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221214204454288.png)

qj,k为药物级别选择评分。

3.3.3拷贝机制。我们将就诊级别和药物级别的分数结合起来，以确定过去就诊中每种药物的复制概率。此外，由于一个药物mi∈M可能在多个过去的处方中使用，我们收集其最终复制概率如下:

![image-20221214204624576](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204624576.png)

其中![image-20221214204829228](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204829228.png)是一个指标函数，如果Mj,k=mi返回1，如果Mj,k不等于mi返回0。所有药物的复制概率为![image-20221214204900920](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204900920.png)。

最后结合生成概率Prg和复制概率Prc进行预测。

![image-20221214204920584](https://gitee.com/ning13445/picture/raw/master/1/image-20221214204920584.png)

Pr表示药物集合M中所有药物的概率，其中概率最大的药物是第t次就诊的第i种药物。

3.4 Training

我们通过最小化规则交叉熵损失来训练模型:

![image-20221214205030141](https://gitee.com/ning13445/picture/raw/master/1/image-20221214205030141.png)

其中R为训练EHR集。Mt,i是第t次就诊的药物集的第i种药物。![image-20221214205209828](https://gitee.com/ning13445/picture/raw/master/1/image-20221214205209828.png)为Mt,i的预测概率，可由式(22)计算。![image-20221214205236248](https://gitee.com/ning13445/picture/raw/master/1/image-20221214205236248.png)表示COGNet中所有可训练参数。

在训练阶段，我们使用teacher-forcing模型进行训练。具体来说，在预测第i种药物时，模型将实际的第(i−1)种药物作为解码器的输入，而不是预测的第(i−1)种药物。在第一步，解码器的输入被设置为⟨START⟩



**Scientific Paper Recommendation: A Survey**

摘要

在科学界推荐同类科学论文的问题称为科学论文推荐。科技论文推荐旨在推荐符合研究者兴趣的新文章或经典文章。由于学术论文的数量呈指数增长，它已成为一个有吸引力的研究领域。本文首先介绍了论文推荐系统的重要性和优点。其次，对基于内容的推荐方法、协同过滤方法、基于图的推荐方法和混合推荐方法进行了综述。然后介绍了不同推荐系统的评价方法。最后，我们总结了论文推荐系统中存在的问题，包括冷启动、稀疏性、可扩展性、隐私性、偶然性和统一的学术数据标准。在全球范围内，推荐服务已经变得非常重要，因为它们支持电子商务应用程序和不同的研究社区。推荐系统在经济、教育、科研等领域有着广泛的应用。不同的实证研究表明，推荐系统在从海量数据中提取有用知识方面比基于关键词的搜索引擎更有效和可靠。在科学界推荐同类科学文章的问题称为科学论文推荐。科学论文推荐旨在推荐符合研究者兴趣的新文章或经典文章。

I. INTRODUCTION

在学术研究中，推荐系统可以为研究人员提供论文，帮助他们快速找到所需的论文。例如，对于发表经验有限的初级研究人员，推荐系统可能会推荐相关领域的新文章和经典文章，以拓宽他们的视野和研究兴趣。相反，对于发表记录较强的资深研究人员，推荐系统主要推荐与其研究兴趣相一致的论文[18]。

与传统的基于关键词的搜索技术相比，论文推荐系统通常考虑研究人员的兴趣、合著者关系和被引关系来设计推荐算法并提供推荐列表。值得注意的是，推荐结果通常是研究人员感兴趣的不同主题。结果的数量可以短且可控，以确保推荐系统的个性化和有效性。

推荐系统引入后，出现了很多推荐算法[25]，[26]。推荐技术主要分为四类:基于内容的推荐(CBF)、协同过滤(CF)、基于图的推荐(GB)和混合推荐。每种方法都有自己的基本原理，为研究人员推荐有趣的文章[25]，[27]。

CBF主要考虑用户的历史偏好和个人库，提取并构建用户的兴趣模型，称为用户档案[10]。然后CBF从候选论文中提取关键词，并计算从用户档案中提取的关键词与候选论文的相似度。对相似度进行排序后，将相似度高的论文推荐给用户。

CF主要关注与该用户个人资料相似的其他用户对其条目的操作或评级，称为“邻居用户”[28]。用户在过去有类似的兴趣，他们可能在未来也会同意。

关于基于图的方法[29]有很多研究。以往的研究构建了以作者和论文为节点的图。论文之间的关系、用户与论文之间的关系以及用户与论文之间的关系被视为边。然后在图上使用随机游走或其他算法来计算用户和论文之间的相关性。

对于混合推荐方法，推荐系统通常使用基于内容的过滤和协同过滤方法来生成推荐，因为这两种方法各有优缺点。基于内容的过滤和协同过滤方法相辅相成，两者结合的推荐系统通常比只运行一种推荐算法的推荐系统更准确。除了上述三种方法外，还有一些论文推荐技术:潜在因子模型[30]和主题回归矩阵分解模型[31]。

本调查的主要贡献包括:

1)常用科技论文推荐方法的分类。

2)深入分析论文推荐系统的评价指标。

3)总结论文推荐系统存在的问题和挑战。

2.论文推荐方法

A.基于内容的推荐(CBF)

作为一种传统的推荐方法，CBF的原理很简单。CBF方法推荐的项目与用户感兴趣的项目[32]相似。项目和用户之间的信息匹配是关键过程。在论文推荐系统中，项目是数字图书馆中的论文，用户是研究人员。在CBF方法中，首先收集研究者的论文。引用研究人员的论文或其他一些信息可以用来建立他的个人资料。	

根据我们的统计数据，有许多方法来建立研究人员的档案。例如，研究者的偏好和兴趣可以通过从研究者的研究领域中提取关键词来表示。论文推荐系统可以从论文的标题、摘要和内容中提取关键词来表示这些论文。这些候选论文可以从数字图书馆检索到。然后，论文推荐系统计算研究人员简介和候选论文之间关键词的相似度，并对其进行排名。以下相似度较高的候选论文推荐给研究人员。

![image-20221215203555269](https://gitee.com/ning13445/picture/raw/master/1/image-20221215203555269.png)

根据其基本原理，我们可以发现CBF的一些优点。CBF系统提取论文信息并进行比较。如果论文与研究者的兴趣相关，它就会被发现。此外，与基于关键词的搜索引擎相比，CBF通常考虑的是当前研究者的兴趣，不涉及其他研究者。如果研究人员的兴趣发生变化，推荐结果列表将在未来发生变化。图2给出了基于内容的推荐系统的总体结构。从图2可以看出，CBF的推荐过程主要包括三个步骤:Item Representation、Profile Learning和推荐生成。

B.协同过滤(cf)

与CBF的推荐技术一样，CF也需要知道用户的兴趣，即使没有基于内容的特性[50]，这对于推荐相关论文尤其有效。CF的基本思想是，如果用户A和用户B对一些共同的项目进行评级，则认为他们的兴趣相似。如果用户B的记录中有一些商品，而用户A的记录中没有，那么这些商品可以推荐给用户A。换句话说，CF是利用其他用户[51]的意见向用户A推荐商品的过程。评级或意见可以从一些社会参考管理网站如CiteULike上获得，或者让用户填写问卷[52]。

![image-20221215212817889](https://gitee.com/ning13445/picture/raw/master/1/image-20221215212817889.png)

协同过滤系统通过考虑用户的评级历史来定位对等用户，并找到相似的用户。然后CF使用邻域生成推荐。CF推荐系统通常需要一个用户-项目矩阵来表示用户对项目的评分或评论。评级可以用来代表用户的兴趣。构建矩阵后，系统会计算用户之间的相似度，找到相似的用户，称为“邻居用户”，进行商品推荐。用户-物品矩阵中的元素是用户的评分。在这个矩阵中，比率为0和1，比率可以用更多的数字来表示喜欢或不喜欢的程度。协同过滤系统的总体结构如图3所示。

与基于内容的过滤方法相比，CF有一些不同的优点:不考虑推荐论文的内容，因为推荐方法依赖于用户的评分，不考虑他们属于什么种类的项目。此外，推荐给用户的项目可能与用户当前的研究无关，因为相似度是衡量用户之间的关系。

CF中主要包含两类方法[53]:

1. 基于用户的方法:用户是基于用户的方法的中心。推荐系统使用其他类似用户的配置文件来推荐[54]。基于用户的CF查找用户的最近邻居。根据邻居的兴趣，预测用户的兴趣[54]。通常，在基于用户的系统中，用户被分为几个组，同一组中的用户对某些项目具有相同或相似的兴趣。推荐系统根据同一组用户的评分为用户进行推荐。

2. 基于项目的方法:基于项目的方法主要关注论文之间的关系，而不是用户[55]，[56]。在基于项目的方法中，假设用户的兴趣在未来是持续的或变化很小的。如果用户对某些商品给出了积极的评价，推荐系统可以通过分析用户的评价历史来收集候选商品。然后推荐系统通过对相似商品的聚类来推荐商品。

上述推荐技术可以根据用户的不同需求，收集必要的数据，推荐论文。来自CiteULike的元数据可以用来运行CF推荐算法，它包含了很多用户和他们在论文[57]上的唯一标签。推荐算法经典而简单:在基于用户的过滤中，将目标用户与收集到的数据进行匹配，找到有相似记录的邻居。一旦找到邻居，邻居历史偏好的所有论文都将被视为推荐给目标用户的候选论文。在基于项目的筛选中，系统通过匹配目标用户的历史记录来推荐论文。

通过对CF论文推荐技术的概述，可以看出CF是一种流行的推荐方法。但由于CF的自然特性，它仍有一些缺点，其中最明显的缺点就是冷启动问题。对于没有评级的新项目，只有在有人对其进行评级后才能推荐。对于对任何项目评分较少的新用户，其评分历史记录为空，系统无法找到类似的邻居，直到他/她获得足够的评分。为了克服CF中存在的问题，研究者们提出了其他一些推荐技术，如基于图的推荐方法和混合推荐方法。

C.基于图的方法(gb)

顾名思义，基于图的方法主要关注图的构造。该图谱可以由引文网络、社会网络等构成。研究者和论文是图的不同节点。研究者之间、研究者与论文之间、论文与论文之间的关系可以看作是节点之间的边。然后推荐系统可以使用像在图上随机行走这样的算法为研究人员找到相关的论文。GB的优势在于，GB可以使用不同来源的信息进行推荐。CB CF只是用了一两种信息。GB可以在推荐系统中加入研究者之间的社会关系、信任关系，从而提高推荐结果。

在基于图的模型中，我们首先需要收集关于研究人员和论文的数据。然后系统用异构图G(V, E)表示，其中V = Vu ∪ Vp, VU代表系统中的研究者，VP是研究者发表或引用的论文集合。

![image-20221215213418974](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221215213418974.png)

对于每个元组(U, P)，图中存在一条边E(vu, vp)，且vu∈Vu vp∈VP。有一个简单的基于图形的模型如图4所示。此外，在一些基于图的推荐系统中，还存在E(vu, vu)， E(vp, vp)这样的边，这意味着它们考虑了研究人员之间的关系，此外，它们还考虑了论文之间的关系。在基于图的模型中，论文推荐活动会转化为图搜索任务[64]。

图中A、B、C、D分别代表系统中不同的研究人员，a、b、c、d、e分别代表他们发表的论文。左边是我们从数字图书馆收集的研究者行为数据。研究人员A发表了论文a，论文b和论文d，可能的研究人员B发表了论文b和论文e。我们使用这些研究人员的行为数据来构建正确部分的网络。在得到研究者和论文的两部分图之后，推荐系统的任务可以转化为计算未连接的用户顶点vu和论文顶点vp之间的相关性。多篇论文提出了许多算法，向研究者推荐相关论文[25]，[65]。

基于图的推荐系统的推荐过程可以概括为两个步骤:图的构建和推荐的生成。

图的构建。如今，许多数字材料被用来阅读和分享给人们。对于学术研究，研究人员从IEEE Xplore和CiteULike等数字图书馆阅读和搜索相关论文。研究人员可以从上述网站上收集用户和论文的数据来构建图表。

除了可以使用研究者和论文构建图之外，还有另一种图:引文图(Citation graph, Network)。引文图包含论文和论文之间的引文关系。节点代表引文网络中的不同论文，边代表论文之间的引文关系。引文图的基本思想是，如果两篇论文有共同的参考文献，或者它们被一篇论文引用，则认为它们是相似的[67]。因此，可以通过分析引文网络的结构来给出推荐。

此外，作者之间的合作作者关系可以添加到引文网络中。这个图表被称为引文协作网络。它有三种不同类型的链接，代表不同的关系：引用关系、协作关系和作者-论文关系[71]。

基于图的论文推荐系统中的算法通常不考虑论文内容的特点和研究者的个人资料。原因是它们不适合作为图的节点进行学术推荐。在图中，研究人员和论文代表了这两种节点。论文推荐系统利用图的结构信息来查找相关论文。



**一种融合用户显隐式阅读偏好的论文推荐模型**

摘 要 

在海量学术文献的个性化推荐中，现存基于内容的方法以 CNN 作为特征提取工具，关注用户的显式阅读偏好，却忽略了全局语义特征，而基于图的方法通常忽略用户和论文之间的高阶关联结构信息。针对以上问题，提出一种混合推荐模型 GNPＲ(Graph Neural Paper Ｒecommendation)，能够学习更完整的用户显式阅读偏好及用户和论文之间的高阶关联信息。该方法使用 Word2vec 和 DCNN(Dual Convolutional Neural Network)处理文本，以双层自注意力的特征抽取模式学习文本全局特征，补充用户显式阅读偏好。针对概念、用户、论文和论文元数据等数据构建知识图谱，使用改进的图卷积网络学习用户和论文之间的高阶关联信息，从而挖掘用户隐式的阅读偏好。

2 推荐方法

2. 1 GNPＲ 框架

![image-20221218212224625](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218212224625.png)

![image-20221218212232670](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218212232670.png)

​       GNPＲ 模型框架结构如图 1 和图 2 所示。用户的阅读偏好向量表示包括两个部分的计算:显式阅读偏好和隐式阅读偏好。用户显式阅读偏好又由文本的局部特征和文本的全局特征组成，如图 1 所示。隐式阅读偏好包含在 GCN 对知识图谱处理后的用户节点向量中，因此将用户和论文及论文的相关元数据抽象为概念知识图谱上的节点，如图 2 所示。最后，推荐计算是使用多层感知机(Multi-Layer Perceptron，MLP)学习匹配函数并输出相关度得分。

2． 2 用户显式阅读偏好
		从文本局部特征和文本全局特征两个方面综合用 户的显式阅读偏好。基于论文标题(或关键词)和摘要的语义，文本局部特征旨在找出句子中最重要的分词特征，文本全局特征则关注于整个句子的语义特征。

![image-20221218212731027](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218212731027.png)

 (1)局部特征抽取器 DCNN。

本文提出局部文本特征提取器 DCNN，其结构如图 3 所示。针对标题和摘要呈现论文特征的差异性， 并分别以标题和摘要输入并行且具有独立参数的 CNN，输出的结果作为论文的**局部特征**。假设标题和摘要的矩阵表示为 T =［w t1 ，w t2 ，…，w tn ］和 A = ［w a1 ，w a2 ，…，w am ］ ，矩阵的列是由 Word2vec 训练的词向量，d 是向量的维数。DCNN 中的 CNN 有一个 卷积层和池化层，对任意论文 p，若经过 CNN 处理的标题和摘要输出向量为![image-20221218213021328](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218213021328.png) ，DCNN 的输出为 e(p)= ![image-20221218213057303](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218213057303.png)，D 是输出向量的维数。

为了判断待推荐论文在多大程度上符合用户历史兴趣，模型基于注意力机制区分历史论文对用户兴趣的贡献。假设用户 u 的点击历史集合为{p u1 ，pu2 ，…，p uk }，经 DCNN 处理后的点击历史为{e(pu1 )，e(pu2 )，…，e(p uk )}，待推荐论文为 e(p j )。最后，将两者的拼接向量输入到神经网络中做非线性变换，由 Softmax 函数计算归一化的权重得分:

![image-20221218213458288](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218213458288.png)

则从用户历史的文本局部特征中得到的显式阅读偏好表示如下:

![image-20221218213518036](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218213518036.png)

(2)全局特征抽取器。

针对文本全局特征，GNPＲ模型采用自注意力机制(self-attention)处理由标题、关键词和摘要组成的短文本。自注意力机制有效获取句子的长距离依赖，在考虑全局信息情况下判定词语的重要程度，文本使用度量函数为句子中的每个分词f self (w i )计算得分，用于表示分词在句子中的重要性，此时不需要任何额外的指引信息(guider)。以计算第t 个标题的表示为例，第 i 个分词的权重为:

![image-20221218214038404](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214038404.png)

则考虑全局依赖的句子表示为:

![image-20221218214100488](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214100488.png)

为了在用户点击历史集合中找到用户对论文 t 的点击意图受其他论文的影响，模型将全局特征抽取器设计为双层的自注意力层形式，若用户 u 的点击历史数为 h，则从用户历史的文本全局特征中得到的显式阅读偏好表示如下:

![image-20221218214125457](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214125457.png)

式中:![image-20221218214153910](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214153910.png)是句子的权重。将 2． 1 节的局部特征和全局特征拼接并输入到全连接网络中，获得用户的显式阅读偏好 ![image-20221218214221804](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214221804.png)，其中 ![image-20221218214242942](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218214242942.png) 。

2． 3 用户隐式阅读偏好

为了建模用户的隐式阅读偏好，本节构造由用户、论文、论文元数据和相关概念组成的知识图谱。针对知识图谱的表示，本文使用改进的图卷积网络学习融合高阶信息的用户节点表示隐含着用户潜在的兴趣。

(1)概念知识图谱构建。本文从论文中获取的概念和其他实体构建成面向推荐的知识图谱 G，目的是关联已知概念和未知的相关概念，并通过高阶关联关系融入到用户和论文表示中，以更好地建模用户隐式的阅读偏好，从而缓解用户-项交互数据稀疏问题。

针对标题、摘要、关键词等数据，本文首先提取TF-IDF 权重较高的词，然后链接 LOD 中准确的概念以及若干跳邻域，例如与链接实体处于上下位关系的概念、概念的实例等等。关于用户与论文之间的关系，若存在交互，在用户和论文实体之间设置“交互”关系边。以上的概念部分子图融合用户-论文二部图 G 1 组成最终的知识图谱 G，

其中包含实体类型:用户、论文、概念和论文的其他元数据等;关系类型:用户与论文的交互关系、论文的引用关系、概念与论文的从属关系、实例与概念的![image-20221218215809756](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215809756.png) 关系、主题与论文从属关系、概念之间的上下位关系。因此，通过知识图谱的组织形式，论文的标题、摘要、关键词中蕴含的语义可通过该概念之间的上下位关联显示出来，而论文其他元数据(如参考文献)则通过论文之间的引用关系保持关联。

(2)基于改进 GCN 的知识图谱表示。针对知识图谱的表示学习，本文使用输出结果包含了实体间高阶关系的图卷积网络(GCN)。首先，GCN 通过传播嵌入的方法获得用户和论文的分布式表示，其中包含用户潜在的阅读偏好，即上文提及的用户隐式兴趣。然而，GCN 一般处理的方式是将知识图谱当成无向图，忽略对关系类型的区分，因此本文预先考虑用户对所有关系的隐含偏好分布［11，13］ 。以下是计算单个 GCN层的某节点 v 嵌入的一般形式:

![image-20221218215021924](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215021924.png)

式中:![image-20221218215101270](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215101270.png)表示邻域聚合函数用于聚合来自邻域的信息，本文使用文献［11］提到的函数 Concataggregator;e v 和 e N v 分别是实体 v 和 v 的邻域的向量表示。

本文模型在邻域的计算方式中融入了关系类型，即每一个邻域实体对邻域表示的贡献度取决于用户和关系的匹配值，例如，用户更喜欢通过引用关系查找论文，则图上的嵌入传播方向则受到相应的影响。假设邻域为![image-20221218220103024](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218220103024.png)，本节定义一个映射![image-20221218220120196](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218220120196.png)(例如内积)计算用户 u 和关系 r 的匹配值。因此邻域的向量表示为:

![image-20221218215151371](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215151371.png)

经过 L 1 层邻域的聚合后，论文节点的向量表示为e p ，用户节点的向量表示，即用户的隐式阅读偏好表示
为 u imt 。论文最终的表示向量为 p = ep ，用户的最终的向量表示为 ![image-20221218215233291](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215233291.png) 。

2． 4 用户-论文交互建模

现存的深度学习对推荐模型的侧重点分为两方面:侧重用户与项目的表示学习，侧重用户与项目的交互建模。与先前的研究不同，通过上文的介绍可知模型 GNPＲ 已经对用户和论文进行了学习表示，接下来利用训练好的用户向量和论文向量进行推荐预测。在交互建模阶段，本文基于用户-论文交互对，拼接训练好的用户向量与用户交互历史的论文向量，以作为交互建模层的输入 x 1 ，在 L 2 次非线性变换后得到预测分数。由以上的计算可知，用户最终表示为 u，候选论文向量表示 p，将最终用户与论文向量输入到交互建模层 MLP 中进行计算:

![image-20221218215308116](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215308116.png)

为了有效地训练 GNPＲ 模型，从隐式反馈中为特定用户采样未交互的论文作为负样本，数量和正样本相同。例如，一个训练样本可以表示为，其中 x 是预测是否单击的候选论文。对于每个正样本，y = 1，否则y =0。文本使用交叉熵损失(cross-entropy)作为损失函数:

![image-20221218215338719](https://gitee.com/ning13445/picture/raw/master/picture/1/image-20221218215338719.png)